Questions:

- When creating a new space, how to place it inside lab notebook or inventory?
- Unzipping a zip file in pybis dataset does not work right?
- In microscopy app, DAT files are now together in just one object. However, each data file has a different header. How are you going to handle this?

Notes: 

One can upload sxm and dat files to the same collection in openBIS. 
One just has to create a TEMPLATE-SXM and a TEMPLATE-DAT samples inside the collection and then change the experiment and sample inside nanonis_importer.py.
Bug in nanonis_importer on line 147. As it was getting all the possible channels from the files before getting the minimum and maximum of the files, there were some cases
where the channels did not exist and it was throwing a ValueError when using .index() in the list inside the function get_channel in spmpy_terry.py

Discussion about STM datasets:

Each STM session should be independent:
- Contains several SXM and several DAT and all of them go into the same view. If there are another session, it goes to another view.
- Check whether the openbis microscopy app follows the trees discussed at the beginning of PREMISE (SXM and DAT files trees)
- SXM and DAT files should be mixed and sequential.
- Replicate a small set of files that Bruno or Lysandr can give us.

Bug in microscopy app scripts:
- bug with div_00003.dat and 00004.dat
- Correct the python code (talk with Lysandr if needed)

2-8-2024:
Create the STM objects inside a collection in the project and then make these objects children of experiment step objects like Annealling, etc.
Changed math to numpy in nanonis_importer.py.
Added 'LI Demod 1 Y (A)','LI Demod 1 Y (A) [bwd] (A)' to channel names together with the respective elements to the other 3 groups??? Ask Lysandr
Change STM, AFM, STS, etc by 1D Measurements, 2D Measurements, 3D Measurements....
Bruno asked to present examples of how to build a Sample Preparation/Sample in openBIS.

5-8-2024:
How to store a sample preparation:
1- Store sample preparation tasks without making a specific object for sample. Connect measurements to the last sample preparation task.
2- Create a sample object and then connect the measurements to the last sample preparation task.
3- Create a Sample preparation object and connect sample object to it. Then connect sample to measurements.
4- Create a sample preparation object and no sample objects. Connect measurement to sample preparation object.

6-8-2024:
Search for ontologies and complete more fields.

8-8-2024:
What is the difference between net charge and charge? In Schema
Updated the presentation for September

Save the conversation with one theory scientist (It was not done on the 8th): 
Change quantitative value to has_measurement_unit?
Use slot_usage to put required in all mandatory attributes (Verify)

 Tight Binding
 - xyz -> atom coords
 - lattice vectors (max 3 vectors)
 - k-points -> vector with 3 doubles >>> always defined between 0 and 2pi
 - lattice: honeycomb is the most used in our case but could be undefined
 - hoppings (doubles but can be complex numbers) [Energy units]
 - hamiltonian (complex numbers) hermitian matrix [Energy units] or functions (in the case of the crystal) ?? output ??
 - comments

 Mean Field Hubbard
 - tight binding (link to TB)
 - on site Hubbard repulsion U (double) [Energy units] so um valor
 - density tolerance (double)  [No unit]
 - number of electrons or charge (-1, 0, +1)
 - up densities -> matrix dimension (number of columns) [No unit]
 - down densities -> matrix dimension (number of columns) [No unit]
 - number of electrons up and the number of electrons down (integer)
 - convergence_coefficient - help with the convergence of the solution (double)
 - number of k-points used in the integral (integer)
 - comments 
 
 Simulation object with general info

 3-9-2024:
 Discussion with Bruno: 
 - For every preparation, there should be a gallery with all SXM and Dat files.
 - The files should be displayed chronologically.
 - If Dat files come together, they should be merged into just one plot.
 - One should be able to split the merged dat files afterwards if needed.

 Sample objects conclusion (Discuss it in the meeting next week): 
 - Create a new sample object after every sample preparation task like (Sample 1 > Task > Sample 1.1)
 - Connect the measurements to the last sample object.

 Should I do one collection with measurements for all the measurements in the project or should I make a collection for every sample preparation?

 Store consecutive dat files together. There might be a case where dat files with an sxm image in-between should be merged but it is ok if it is not possible.

 nanonis_importer.py is now placing the measurement chronologically, merging dat files whenever they are consecutive.
+
 IMPORTANT: The exact location of the dat measurements in the sample should appear in the microscopy app? -> Discuss with Bruno and probably openBIS team.

 IMPORTANT: One measurement collection per sample preparation.

 DISCUSS WITH BRUNO: On the slide 5 of the G:\openBIS\ORD PREMISE\GUI, Style File\Lab205_microscopy_GUI_initial_concept.pptx, there is an image where the experimentalists combine dat measurements with an SXM measurement. To select the SXM measurement, we could take the coordinates of the dat measurements and try to find the best SXM match (one where the coords are not out of range). There should also be a manual option.

 Working on inventory excel. -> Trying to replicate it inside openBIS.
 Working on how the default channels are selected when uploading measurement files to openBIS.

4-9-2024:
Working on the selection of default channels for the measurements. If dat files that were taken together correspond to different measurement types, they should be grouped by type.
Working on the mapping of the instruments' excel metadata into openBIS.

5-9-2024:
Talked with Edan about the PREMISE' tasks. I should ask Bruno whether they trigger simulations using information from the experiments, e.g. using the same parameters used in the lab to build a certain sample.

6-9-2024:
What should be stored in a transference? Room to Room or Location to Location? Location is the exactly place where the item is, like inside a drawer or inside an instrument.