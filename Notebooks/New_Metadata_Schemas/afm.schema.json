{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "https://example.com/afm.schema.json",
    "title": "AFM",
    "openBISCode": "AFM",
    "description": "An AFM",
    "type": "object",
    "properties": {
        "name": {
            "title": "Name",
            "type": "string",
            "openBISType": "VARCHAR",
            "description": "Name"
        },
        "recording_time": {
            "title": "Recording time",
            "type": "string",
            "openBISType": "TIMESTAMP",
            "description": "Recording time",
            "format": "date-time"
        },
        "duration": {
            "title": "Duration",
            "type": "object",
            "openBISType": "JSON",
            "description": "Duration",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "bias_settings": {
            "title": "Bias settings",
            "type": "object",
            "openBISType": "JSON",
            "description": "Bias voltage settings",
            "properties": {
                "setpoint": {
                    "type": "object",
                    "description": "Setpoint",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibration_factor": {
                    "type": "object",
                    "description": "Calibration factor",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibration_offset": {
                    "type": "object",
                    "description": "Calibration offset",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "current_settings": {
            "title": "Current settings",
            "type": "object",
            "openBISType": "JSON",
            "description": "Current settings",
            "properties": {
                "setpoint": {
                    "type": "object",
                    "description": "Setpoint",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibration_factor": {
                    "type": "object",
                    "description": "Calibration factor",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "calibration_offset": {
                    "type": "object",
                    "description": "Calibration offset",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "gain": {
                    "type": "number",
                    "description": "Gain"
                }
            }
        },
        "z": {
            "title": "Z",
            "type": "object",
            "openBISType": "JSON",
            "description": "Tip position in Z axis",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "feedback_settings": {
            "title": "Feedback settings",
            "type": "object",
            "openBISType": "JSON",
            "description": "Feedback settings",
            "properties": {
                "feedback_active": {
                    "type": "string",
                    "description": "Whether feedback is active",
                    "enum": ["active", "inactive"]
                },
                "feedback_type": {
                    "type": "string",
                    "description": "Feedback type",
                    "enum": ["Log current", "Abs current"]
                }
            }
        },
        "z_controller_settings": {
            "title": "Z-Controller settings",
            "type": "object",
            "openBISType": "JSON",
            "description": "Z-Controller settings",
            "properties": {
                "setpoint": {
                    "type": "object",
                    "description": "Setpoint",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "p_gain": {
                    "type": "number",
                    "description": "Proportional gain"
                },
                "i_gain": {
                    "type": "number",
                    "description": "Integral gain"
                },
                "time_constant": {
                    "type": "object",
                    "description": "Time constant",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "tip_lift": {
                    "type": "object",
                    "description": "Position of the tip when feedback loop is off",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "switch_off_delay": {
                    "type": "object",
                    "description": "Time delay applied when switching off feedback loop",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                }
            }
        },
        "piezo_configuration_settings": {
            "title": "Piezo configuration settings",
            "type": "object",
            "openBISType": "JSON",
            "description": "Piezo configuration settings",
            "properties": {
                "active_calib": {
                    "type": "object",
                    "description": "Setpoint",
                    "enum": ["LHe"]
                },
                "sensitivity": {
                    "type": "object",
                    "description": "Sensitivity",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "z": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "hv_gain": {
                    "type": "object",
                    "description": "HV Gain",
                    "properties": {
                        "x": {
                            "type": "number"
                        },
                        "y": {
                            "type": "number"
                        },
                        "z": {
                            "type": "number"
                        }
                    }
                },
                "scan_slope": {
                    "type": "object",
                    "description": "Scan slope",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "curvature_radius": {
                    "type": "object",
                    "description": "Curvature radius",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "second_order_correction": {
                    "type": "object",
                    "description": "2nd order correction",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "drift": {
                    "type": "object",
                    "description": "Drift",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "z": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "drift_correction_status": {
                    "type": "boolean",
                    "description": "Whether the drift correction is performed"
                }
            }
        },
        "scan_settings": {
            "title": "Scan settings",
            "type": "object",
            "openBISType": "JSON",
            "description": "Scan settings",
            "properties": {
                "field": {
                    "type": "array",
                    "items": {
                        "type": "number"
                    },
                    "description": "The scanfield of the image"
                },
                "angle": {
                    "type": "object",
                    "description": "Angle",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "offset": {
                    "type": "object",
                    "description": "Offset",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "time": {
                    "type": "object",
                    "description": "Time",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "range": {
                    "type": "object",
                    "description": "Range",
                    "properties": {
                        "x": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "y": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "pixels": {
                    "type": "object",
                    "description": "Pixels",
                    "properties": {
                        "x": {
                            "type": "number"
                        },
                        "y": {
                            "type": "number"
                        }
                    }
                },
                "speed": {
                    "type": "object",
                    "description": "Speed",
                    "properties": {
                        "forward": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "backwards": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        }
                    }
                },
                "direction": {
                    "type": "string",
                    "description": "Direction",
                    "enum": ["down", "both"]
                }
            }
        },
        "dwell_time": {
            "title": "Dwell time",
            "type": "object",
            "openBISType": "JSON",
            "description": "Acquisition time for each point value in data",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "sample_temperature": {
            "title": "Sample temperature",
            "type": "object",
            "description": "Sample temperature",
            "openBISType": "JSON",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "recording_temperature": {
            "title": "Room temperature",
            "type": "object",
            "description": "Room temperature",
            "openBISType": "JSON",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "oscillation_control_settings": {
            "title": "Oscillation control settings",
            "type": "object",
            "openBISType": "JSON",
            "description": "Oscillation control settings",
            "properties": {
                "differential_input": {
                    "type": "boolean",
                    "description": "Whether differential input is used"
                },
                "oneTen": {
                    "type": "boolean",
                    "description": "Whether the input is attenuated by a factor of 10"
                },
                "input_calibration": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "input_range": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "center_frequency": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "range": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "demodulation_settings": {
                    "type": "object",
                    "description": "Demodulation settings",
                    "properties": {
                        "inputs": {
                            "type": "array",
                            "items": {
                                "type": "number"
                            }
                        },
                        "frequencies": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "value": {
                                        "type": "number"
                                    },
                                    "unit": {
                                        "type": "string"
                                    }
                                }
                            }
                        },
                        "reference_phases": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "value": {
                                        "type": "number"
                                    },
                                    "unit": {
                                        "type": "string"
                                    }
                                }
                            }
                        },
                        "cutoff_frequencies": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "value": {
                                        "type": "number"
                                    },
                                    "unit": {
                                        "type": "string"
                                    }
                                }
                            }
                        },
                        "harmonics": {
                            "type": "array",
                            "items": {
                                "type": "object",
                                "properties": {
                                    "value": {
                                        "type": "number"
                                    },
                                    "unit": {
                                        "type": "string"
                                    }
                                }
                            }
                        },
                        "filters_orders": {
                            "type": "array",
                            "items": {
                                "type": "number"
                            }
                        }
                    }
                },
                "phase_settings": {
                    "type": "object",
                    "description": "Phase settings",
                    "properties": {
                        "p_gain": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "i_gain": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "controller_on": {
                            "type": "boolean",
                            "description": "Whether the phase controller is on"
                        }
                    }
                },
                "frequency_shift": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "amplitude_settings": {
                    "type": "object",
                    "description": "Amplitude settings",
                    "properties": {
                        "setpoint": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "p_gain": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "i_gain": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "controller_on": {
                            "type": "boolean",
                            "description": "Whether the amplitude controller is on"
                        }
                    }
                },
                "excitation": {
                    "type": "object",
                    "properties": {
                        "value": {
                            "type": "number"
                        },
                        "unit": {
                            "type": "string"
                        }
                    }
                },
                "output_settings": {
                    "type": "object",
                    "description": "Output settings",
                    "properties": {
                        "amplitude_range": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            }
                        },
                        "active": {
                            "type": "boolean",
                            "description": "Whether the output is on",
                            "enum": ["active", "inactive"]
                        },
                        "add": {
                            "type": "boolean",
                            "description": "Whether to add the signal at the ADD connector of the OC4 to the output signal",
                            "enum": ["active", "inactive"]
                        }
                    }
                },
                "pll_setup_settings": {
                    "type": "object",
                    "description": "PLL setup settings",
                    "properties": {
                        "qFactor": {
                            "type": "number",
                            "description": "Q-factor"
                        },
                        "demodulation_bw_amp": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            },
                            "description": "Demodulation bandwidth of the amplitude controller"
                        },
                        "demodulation_bw_pha": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            },
                            "description": "Demodulation bandwidth of the phase controller"
                        },
                        "amplitude_excitation_ratio": {
                            "type": "object",
                            "properties": {
                                "value": {
                                    "type": "number"
                                },
                                "unit": {
                                    "type": "string"
                                }
                            },
                            "description": "Amplitude to excitation ratio at the resonance"
                        }
                    }
                }
            }
        },
        "comments": {
            "title": "Comments",
            "type": "string",
            "openBISType": "MULTILINE_VARCHAR",
            "description": "Comments"
        },
        "scan_dx": {
            "title": "Scan dx",
            "type": "object",
            "openBISType": "JSON",
            "description": "Increment in x and y (ask whether it is used for z)",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "scan_z_min": {
            "title": "Scan Z-min",
            "type": "object",
            "openBISType": "JSON",
            "description": "Minimum distance between the probe particle and the substract",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "scan_z_max": {
            "title": "Scan Z-max",
            "type": "object",
            "openBISType": "JSON",
            "description": "Maximum distance between the probe particle and the substract",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "amplitude": {
            "title": "Amplitude",
            "type": "object",
            "openBISType": "JSON",
            "description": "Amplitude",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "resonance_frequency": {
            "title": "Resonance frequency",
            "type": "object",
            "description": "Resonance frequency",
            "openBISType": "JSON",
            "properties": {
                "value": {
                    "type": "number"
                },
                "unit": {
                    "type": "string"
                }
            }
        },
        "p_model": {
            "title": "P-model",
            "type": "string",
            "openBISType": "CONTROLLEDVOCABULARY",
            "description": "Type of the theory approximation (single probe, 2PP RESP PTCTA, 2PP RESP pentacene)",
            "enum": ["Single probe", "2PP RESP PTCTA", "2PP RESP pentacene"]
        },
        "wfms_uuid": {
            "title": "WFMS UUID",
            "type": "string",
            "openBISType": "VARCHAR",
            "description": "Unique identifier of the simulation object in the WFMS"
        },
        "annealing": {
            "$ref": "./annealing.schema.json",
            "description": "Details about the annealing"
        },
        "deposition": {
            "$ref": "./deposition.schema.json",
            "description": "Details about the deposition"
        },
        "dft": {
            "$ref": "./dft.schema.json",
            "description": "Details about the DFT parameters"
        },
        "tb": {
            "$ref": "./tb.schema.json",
            "description": "Details about the TB parameters"
        }
    },
    "additionalProperties": false,
    "required": ["name", "recording_time", "duration", "bias_settings", "current_settings", "z"]
}